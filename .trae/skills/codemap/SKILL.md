---
name: codemap
description: "Provides architectural context for the Telegram bot codebase.
Explains project structure, data flow, and dependencies before generating or modifying code.
Ensures new code fits the existing architecture and style."
---

# Codemap — Telegram Bot Architecture

Codemap обеспечивает актуальный архитектурный контекст проекта Telegram-бота.
Навык используется перед генерацией или изменением кода, чтобы новые решения
органично встраивались в существующую структуру проекта.

---

## Purpose

Codemap не переизучает проект с нуля.
Он восстанавливает архитектурную картину:
- где находится точка входа
- как устроен поток обработки сообщений
- где размещается бизнес-логика
- какие модули и утилиты уже существуют

---

## Responsibilities

При активном Codemap модель должна:

1. Определить текущую структуру проекта:
   - назначение основных директорий и файлов
   - точку запуска бота
   - расположение handlers / сервисов / утилит
2. Понять поток выполнения:
   - инициализация
   - регистрация обработчиков
   - обработка событий Telegram
3. Перед генерацией кода:
   - объяснить, в какой файл и почему вносится изменение
   - проверить, нет ли уже аналогичной логики
4. Генерировать код, который:
   - соответствует стилю проекта
   - минимально вторгается в существующую архитектуру
   - готов к немедленной интеграции

---

## When Codemap Is Used

Codemap применяется, если запрос касается:
- добавления команд или handlers
- изменения логики бота
- рефакторинга
- подключения API, БД, кеша
- настройки конфигураций, env, деплоя
- вопросов «как здесь всё работает»

---

## Code Generation Rules

При генерации кода модель обязана:

- писать комментарии на русском языке
- использовать аннотации типов (если Python)
- соблюдать DRY и KISS
- не переписывать существующий код без необходимости
- явно указывать:
  - файл для изменения
  - необходимые импорты
  - дополнительные настройки или env

Если требуется сторонняя библиотека — обосновать её использование.

---

## Output Format

Ответ должен содержать:

1. Краткий архитектурный контекст
2. План изменений
3. Код, разбитый по файлам
4. Дополнительные шаги (настройка, запуск, проверка)

---

## Strict Rules

- Не генерировать код без понимания архитектуры
- Не дублировать существующую функциональность
- Не предлагать «универсальные» решения в отрыве от проекта

Codemap — архитектурный слой принятия решений.